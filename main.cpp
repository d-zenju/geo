//
//  main.cpp
//  geo
//
//  Created by ZENJU Daisuke on 2015/12/24.
//  Copyright © 2015年 ZENJU Daisuke. All rights reserved.
//

#include <iostream>
#include "geo.hpp"

int main(int argc, const char * argv[]) {
    // insert code here...
    double ownLat = 35.32136389;
    double ownLon = 139.78674742;
    double ownHgt = 23.8;
    /*
    double otherLat =  35.284769;
    double otherLon =  139.757393;
    double otherHgt =  0.0;
    */
    double other[][4] = {
        {431101108, 35.408926, 139.650247, 0.000000},
        {431773000, 35.437220, 139.749272, 0.000000},
        {431999563, 35.296777, 139.735971, 0.000000},
        {431400539, 35.444339, 139.824243, 0.000000},
        {431103000, 35.455350, 139.643283, 0.000000},
        {431001049, 35.363729, 139.875756, 0.000000},
        {431100549, 35.221028, 139.716242, 0.000000},
        {431000972, 35.472828, 139.796157, 0.000000},
        {431000795, 35.284285, 139.675998, 0.000000},
        {431000742, 35.435521, 139.759020, 0.000000},
        {431000080, 35.469044, 139.780185, 0.000000},
        {431000785, 35.359753, 139.712801, 0.000000},
        {431003749, 35.451978, 139.657442, 0.000000},
        {431600379, 35.284769, 139.757393, 0.000000},
        {352438000, 35.461147, 139.718628, 0.000000},
        {441613000, 35.183577, 139.745887, 0.000000},
        {431000123, 35.480890, 139.784002, 0.000000},
        {354942000, 35.168646, 139.776487, 0.000000},
        {431500461, 35.346224, 139.814658, 0.000000},
        {431002774, 35.511217, 132.807300, 0.000000},
        {431000987, 35.450472, 139.658509, 0.000000},
        {431100961, 35.208358, 139.743741, 0.000000},
        {431004341, 35.568020, 139.845613, 0.000000},
        {477815600, 35.345081, 139.745824, 0.000000},
        {212500000, 35.481359, 139.784272, 0.000000},
        {477786500, 35.096421, 139.740960, 0.000000},
        {431501791, 35.387466, 139.642687, 0.000000},
        {431101042, 35.343983, 139.818833, 0.000000},
        {431006958, 35.173995, 139.777948, 0.000000},
        {431000647, 35.425256, 139.843596, 0.000000},
        {431000238, 35.220722, 139.715236, 0.000000},
        {431005054, 35.459440, 139.716316, 0.000000},
        {431004011, 35.504602, 139.743903, 0.000000},
        {431001549, 35.356740, 139.852903, 0.000000},
        {477444600, 35.445858, 139.693518, 0.000000},
        {431001094, 35.356621, 139.848289, 0.000000}
    };
    
    
    double ownECEF[3] = {0.0, 0.0, 0.0};
    double otherECEF[3] = {0.0, 0.0, 0.0};
    double enu[3] = {0, 0, 0};
    
    geo::blh2ecef(&ownLat, &ownLon, &ownHgt, ownECEF);
    printf("own: [%f,%f,%f], [%f,%f,%f]\n"
           , ownLat, ownLon, ownHgt, ownECEF[0], ownECEF[1], ownECEF[2]);
    
    int max = sizeof(other) / sizeof(other[0]);
    //int max = 2;
    for (int i = 0; i < max; ++i) {
        for (int j = 0; j < 3; ++j) {
            otherECEF[j] = 0.0;
            enu[j] = 0.0;
        }
        
        printf("\nNo. %d : %d\n", i, int(other[i][0]));
        
        geo::blh2ecef(&other[i][1], &other[i][2], &other[i][3], otherECEF);
        
        geo::ecef2enu(ownECEF, otherECEF, enu);
        printf("angle: %f\n", geo::angle(enu[0], enu[1]));
        printf("dist: %f \n", geo::distance(enu[0], enu[1]));
    }
    
    
    /*
    double *own = geo::blh2ecef(&ownLat, &ownLon, &ownHgt);
    double *other = geo::blh2ecef(&otherLat, &otherLon, &otherHgt);
    
    double enu[3];
    geo::ecef2enu(own, other, enu);
    
    printf("%f %f %f\n", other[0], other[1], other[2]);
    printf("%f %f %f\n", enu[0], enu[1], enu[2]);
    
    printf("angle: %f\n", geo::angle(enu[0], enu[1]));
    printf("dist: %f \n", geo::distance(enu[0], enu[1]));
    */
    return 0;
}
